<!DOCTYPE html>
<html lang="en">
<head>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-KN6QXFQ161"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-KN6QXFQ161');
  </script>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Forecastler – About Us</title>
  <link rel="icon" href="images/favicon.ico" type="image/x-icon">
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      padding: 0;
      background: url('https://i.imgur.com/5dotoQI.jpg') no-repeat center center fixed;
      background-size: cover;
      color: #333;
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 2rem;
      background-color: rgba(0, 0, 0, 0.6);
      color: white;
      position: sticky;
      top: 0;
      z-index: 1000;
    }
    header .logo {
      font-size: 1.5rem;
      font-weight: bold;
    }
    header .language-select span {
      font-size: 1.5rem;
      margin-left: 0.5rem;
      cursor: pointer;
    }
    .main-section {
      background-color: rgba(135, 206, 235, 0.45);
      color: white;
      margin: 2rem auto;
      padding: 2rem;
      max-width: clamp(720px, 90vw, 1100px);
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      box-sizing: border-box;
    }
    .illustration {
      text-align: center;
      margin-bottom: 1rem;
    }
    .illustration img {
      max-width: 100%;
      height: auto;
      border-radius: 10px;
    }
    .main-section h1,
    .main-section h2 {
      text-align: center;
      margin-bottom: 1rem;
      color: #F0F8FF;
    }
    textarea {
      width: 100%;
      box-sizing: border-box;
      padding: 1rem;
      font-size: 1rem;
      margin-bottom: 1rem;
    }
    #kontekst {
      height: 200px;
      max-height: 400px;
      overflow-y: auto;
    }
    #pitanje {
      height: 100px;
    }
    button {
      background-color: #4b6cb7;
      color: white;
      padding: 0.7rem 1.5rem;
      border: none;
      cursor: pointer;
      font-size: 1rem;
      border-radius: 5px;
    }
    button:hover {
      background-color: #3b5aa6;
    }
    .odgovor-box {
      margin-top: 1rem;
      padding: 1rem;
      background-color: #e2e8f0;
      border-left: 5px solid #4b6cb7;
      color: black;
    }

    body[dir="rtl"] {
      text-align: right;
      direction: rtl;
      font-family: 'Cairo', 'Arial', 'Tahoma', sans-serif;
    }

    body[dir="rtl"] input,
    body[dir="rtl"] textarea {
      text-align: right;
      direction: rtl;
    }

    body[dir="rtl"] li {
      text-align: right;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 2rem;
      background-color: rgba(0, 0, 0, 0.6);
      color: white;
      flex-wrap: wrap;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .logo-img {
      height: 42px;
      width: auto;
      border-radius: 50%;
    }

    .site-title {
      font-size: 1.5rem;
      font-weight: bold;
      color: white;
    }

    @media (max-width: 600px) {
      .header-left {
        flex-direction: row;
        justify-content: center;
        width: 100%;
      }

      .site-title {
        font-size: 1.2rem;
      }

      /* === Header menu (hamburger) === */
.menu-wrap{ position: relative; }

      .menu-button{
        display:inline-flex; flex-direction:column; justify-content:center; gap:4px;
        width:42px; height:42px; border:none; border-radius:.6rem;
        background: var(--btn-blue); color:#fff; cursor:pointer;
      }
      .menu-button:hover, .menu-button:focus{ background: var(--btn-blue-hover); outline:none; }

      /* tri vodoravne bele linije */
      .menu-button .bar{
        width:22px; height:2px; background:#fff; display:block; margin:0 auto;
      }

      /* padajuća lista */
      .menu-dropdown{
        position:absolute; top: calc(100% + 8px); right:0; /* poravnanje uz dugme */
        min-width: 180px;
        background: rgba(0,0,0,.9);
        border-radius: 10px;
        box-shadow: 0 8px 20px rgba(0,0,0,.25);
        padding:.4rem;
        display:none;
        z-index: 1200;
      }
      .menu-dropdown.open{ display:block; }

      .menu-item{
        display:block; padding:.6rem .8rem; border-radius:.5rem;
        color:#fff; text-decoration:none; font-weight:600;
      }
      .menu-item:hover{ background: rgba(255,255,255,.12); }

      /* RTL podrška: padajuće ulevo od dugmeta */
      body[dir="rtl"] .menu-dropdown{ left:0; right:auto; }

      /* Mali ekrani: menu dugme ostaje kompaktno uz logo i naslov */

      @media (max-width:600px){
        .menu-button{ width:40px; height:40px; }
      }

      .menu-container {
        position: relative;
        display: inline-block;
        margin-left: 15px;
      }

      .menu-btn {
        width: 42px;
        height: 42px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        border: none;
        border-radius: .6rem;
        background: var(--btn-blue);
        color: #fff;
        cursor: pointer;
      }
      .menu-btn:hover,
      .menu-btn:focus {
        background: var(--btn-blue-hover);
        outline: none;
      }

      .menu-dropdown {
        display: none;
        position: absolute;
        top: 40px;
        left: 0;
        background-color: rgba(0,0,0,0.9);
        min-width: 150px;
        z-index: 1000;
        border-radius: 5px;
      }

      .menu-dropdown a {
        color: white;
        padding: 10px 15px;
        text-decoration: none;
        display: block;
      }

      .menu-dropdown a:hover {
        background-color: rgba(255,255,255,0.2);
      }

      .language-select {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        margin-top: 0.5rem;
        width: 100%;
      }

      header {
        flex-direction: column;
        align-items: center;
      }
    }

    :root{
      --btn-blue:#1e3a8a;
      --btn-blue-hover:#172554;
      --chip-ice:#dbeafe;        /* nežno svetlo plava */
      --chip-text:#0f172a;       /* tamnoplava za tekst na ice */
    }

    /* DEFAULT chip */
    .subject-chip{
      display:inline-flex; align-items:center; justify-content:center;
      padding:.45rem .9rem;
      border-radius:9999px;
      background:var(--chip-ice);
      color:var(--chip-text);
      border:2px solid var(--btn-blue);
      font-weight:600;
      cursor:pointer;
      box-shadow:0 1px 0 rgba(0,0,0,.12);
      transition:transform .06s ease, background .15s ease;
    }
    .subject-chip:hover{ transform:translateY(-1px); }

    /* AKTIVNI chip */
    .subject-chip.active{
      background:#0093DD;
      color:#fff;
      border-color:var(--btn-blue);
    }

    :root{
      --btn-blue:#1e3a8a;        /* tamno plava */
      --btn-blue-hover:#172554;  /* tamnija na hover/focus */
    }

    .btn{
      display:inline-flex; align-items:center; gap:.5rem;
      padding:.6rem 1rem; border:none; border-radius:.6rem;
      background:var(--btn-blue); color:#fff; font-weight:600; cursor:pointer;
    }
    .btn:hover, .btn:focus{ background:var(--btn-blue-hover); outline:none }
    .btn:disabled{ opacity:.5; cursor:not-allowed }

    .btn-icon{ width:20px; height:20px; flex:0 0 20px }
    .btn-label{ line-height:1 }

    @media (max-width:640px){
      .btn{ padding:.6rem }      /* kompaktnije */
      .btn-label{ display:none } /* samo ikonice */
    }

    /* Omotač oko textarea da bismo mogli da pozicioniramo ikonice unutra */
    .context-wrap{ position: relative; }

    /* Daj prostora da tekst ne upadne ispod plutajućih dugmadi */
    #kontekst{
      padding-right: 92px;   /* prostor za dve ikonice desno */
      padding-bottom: 56px;  /* malo prostora ispod */
    }

    /* Kontejner za ikonice u dnu textarea */
    .floating-actions{
      position: absolute;
      right: 8px;
      bottom: 8px;
      display: flex;
      gap: 8px;
    }

    /* === Floating SEND unutar drugog placeholdera === */
    .question-wrap { position: relative; }

    /* da tekst ne upada ispod dugmeta */
    #pitanje {
      padding-right: 56px;
      padding-bottom: 56px;
    }

    /* zadržavamo .btn-label zbog prevoda, ali je vizuelno krijemo */
    .icon-btn .btn-label { display: none; }

    /* (opciono) ako želite da u RTL režimu dugme bude dole levo */
    body[dir="rtl"] .question-wrap .floating-actions { left: 8px; right: auto; }

    /* Kompaktno ikonično dugme (u tamno plavoj) */
    .icon-btn{
      width: 42px; height: 42px;
      display: inline-flex; align-items: center; justify-content: center;
      border: none; border-radius: .6rem;
      background: var(--btn-blue); color: #fff; cursor: pointer;
    }
    .icon-btn:hover, .icon-btn:focus{ background: var(--btn-blue-hover); outline: none; }

    /* Ravnanje redova sa dugmadima i fleksibilnim inputom */
    .subject-manager{
      display: grid !important;
      grid-template-columns: auto minmax(160px, 1fr) auto auto;
      gap: .5rem;
      align-items: center;
    }

    /* Input sme da se skupi ispod širine sadržaja */
    #subject-name{
      min-width: 0;
    }

    /* Spreči lomljenje teksta u dugmadi */
    .btn-label{
      white-space: nowrap;
    }

    @media (max-width: 520px){
      .subject-manager{
        grid-template-columns: auto minmax(120px, 1fr) auto auto; /* 4 kolone i na mobilnom */
        column-gap: .4rem;
      }
      .btn{ padding:.5rem .6rem; }           /* kompaktnije dugmadi */
      #subject-name{ min-width: 0; }         /* spreči prelivanje inputa */
    }

    /* === Fix: subject chips na mobilnom da ne zauzimaju punu širinu === */
    #subject-list{
      display:flex;
      flex-wrap:wrap;
      align-items:center;
      justify-content:flex-start;
    }

    .subject-chip{
      flex: 0 0 auto !important;   /* ne rasteži se */
      white-space: nowrap;          /* ne lomi tekst u 2 reda */
      max-width: 100%;
    }

    /* Na malim ekranima malo kompaktnije dugme-čipovi */
    @media (max-width: 600px){
      .subject-chip{
        padding: .4rem .7rem;
        font-size: .95rem;
      }
    }

    /* --- Desktop nav: po difoltu skrivena (mobilni prikaz) --- */
    .desktop-nav{
      display: none;
    }

    /* --- Linkovi u desktop navigaciji --- */
    .desktop-nav a{
      color: #fff;
      text-decoration: none;
      margin: 0 .9rem;
      font-weight: 600;
      line-height: 1;
    }
    .desktop-nav a:hover{
      text-decoration: underline;
    }

    /* --- Desktop raspored (≥ 601px) --- */
    @media (min-width: 601px){
      /* sakrij hamburger na desktopu */
      .menu-container{ display: none; }

      /* centriraj nav u hederu */
      header{
        display:flex;
        align-items:center;
        gap: 1rem;
      }
      .header-left{ /* logo+naslov ostaju levo */
        display:flex; align-items:center; gap:1rem;
      }
      .desktop-nav{
        display:flex;            /* prikaži linkove */
        flex: 1;                 /* zauzmi sredinu */
        justify-content: center; /* centriraj vodoravno */
        gap: .25rem;
      }
      .language-select{
        margin-left: auto;       /* guraj zastavice desno */
        display:flex; align-items:center; gap:.35rem;
      }
    }

  </style>
</head>
<body>

  <header>
    <div class="header-left">
      <img src="images/transparentlogo.png" alt="Forecastler logo" class="logo-img" />
      <div class="site-title">Forecastler</div>
      <div class="menu-container">
        <button class="menu-btn" onclick="toggleMenu()">&#9776;</button>
        <div class="menu-dropdown" id="menuDropdown">
          <a id="mnav-home"    href="index.html">Home</a>
          <a id="mnav-about"   href="about.html">About Us</a>
          <a id="mnav-contact" href="contact.html">Contact</a>
          <a id="mnav-blog"    href="blog.html">Blog</a>
        </div>
      </div>
    </div>

    <nav class="desktop-nav" aria-label="Primary">
      <a id="nav-home"    href="index.html">Home</a>
      <a id="nav-about"   href="about.html">About Us</a>
      <a id="nav-contact" href="contact.html">Contact</a>
      <a id="nav-blog"    href="blog.html">Blog</a>
    </nav>

    <div class="language-select">
      <span onclick="setLanguage('ar')"><img src="flags/sa.png" alt="AR" width="24" height="18"></span>
      <span onclick="setLanguage('de')"><img src="flags/de.png" alt="DE" width="24" height="18"></span>
      <span onclick="setLanguage('en')"><img src="flags/gb.png" alt="EN" width="24" height="18"></span>
      <span onclick="setLanguage('es')"><img src="flags/es.png" alt="ES" width="24" height="18"></span>
      <span onclick="setLanguage('fr')"><img src="flags/fr.png" alt="FR" width="24" height="18"></span>
      <span onclick="setLanguage('hi')"><img src="flags/in.png" alt="HI" width="24" height="18"></span>
      <span onclick="setLanguage('it')"><img src="flags/it.png" alt="IT" width="24" height="18"></span>
      <span onclick="setLanguage('ja')"><img src="flags/jp.png" alt="JA" width="24" height="18"></span>
      <span onclick="setLanguage('pl')"><img src="flags/pl.png" alt="PL" width="24" height="18"></span>
      <span onclick="setLanguage('pt')"><img src="flags/pt.png" alt="PT" width="24" height="18"></span>
      <span onclick="setLanguage('ru')"><img src="flags/ru.png" alt="RU" width="24" height="18"></span>
      <span onclick="setLanguage('sr')"><img src="flags/rs.png" alt="SR" width="24" height="18"></span>
      <span onclick="setLanguage('tr')"><img src="flags/tr.png" alt="TR" width="24" height="18"></span>
      <span onclick="setLanguage('uk')"><img src="flags/ua.png" alt="UA" width="24" height="18"></span>
      <span onclick="setLanguage('zh')"><img src="flags/cn.png" alt="ZH" width="24" height="18"></span>
    </div>
  </header>

  <!-- SECTION 1: Predicting the Future -->
  <div class="main-section">
    <h2 id="how-title">Predicting the Future</h2>
    <p id="how-text-1">People have always wanted to peek into their own future—to reduce uncertainty, make better decisions, and protect what matters to them. Throughout history there have been many attempts to predict outcomes: from palm reading and casting lots or bones, to seers and prophets, and to the astrological systems of the modern era.</p>
    <p id="how-text-2">Although culturally and symbolically significant, these methods were limited in accuracy and verifiability. The scientific approach starts with cause and effect: if all relevant parameters are known and governed by stable laws, an outcome can be estimated—and sometimes calculated—with high precision.</p>
    <p id="how-text-3">Weather forecasting is a classic example: with sound measurements, models, and mathematics, good data yields useful predictions. In the real world, however, we rarely have complete data; systems are complex and sensitive to initial conditions, so it is more practical to speak in terms of probability rather than certainty.</p>
    <p id="how-text-4">In the philosophy of science, there is the metaphor of Laplace’s demon—an ideal intellect that, if it knew the position and velocity of every particle in the universe, could compute both the past and the future. In practice, such complete knowledge does not exist.</p>
    <p id="how-text-5">Even so, the idea highlights a key point: the more complete and higher-quality our data, the more reliable the forecasts. This is where modern artificial intelligence is useful—as a tool that rapidly integrates large volumes of information and provides probability estimates of future outcomes.</p>
  </div>

  <!-- SECTION 2: How Forecastler Works -->
  <div class="main-section">
    <h2 id="work-title">How Forecastler Works</h2>
    <p id="work-text-1"><strong>Forecastler</strong> uses artificial intelligence as a contemporary approach to prediction, making it one of the pioneering attempts to produce individual forecasts in a transparent, understandable, and statistically grounded way.</p>
    <p id="work-text-2"><strong>1) User input:</strong> You enter information about the subject whose future interests you (a person, object, location, event, etc.) and ask a question that permits a binary answer (YES/NO).</p>
    <p id="work-text-3"><strong>2) Data processing:</strong> The AI treats your information as variables in a model, links them to its knowledge base and relevant statistics, and applies rules of reasoning and mathematical methods.</p>
    <p id="work-text-4"><strong>3) Probability estimate:</strong> Based on the processed data, the system returns a YES/NO answer together with a probability (in percent). Wherever possible, it relies on statistical reasoning and scientifically grounded patterns.</p>
    <p id="work-text-5"><strong>4) Input quality = output quality:</strong> If the input contains little or unclear information, the AI relies more on general averages and broad patterns. The more detail you provide, the narrower the range of possible outcomes and the more precise the forecast becomes.</p>
    <p id="work-text-6"><strong>5) Limitations:</strong> The AI can be wrong—especially when inputs are sparse or contradictory, or when events depend on many unpredictable factors. Forecastler does not claim to know the future; it estimates probabilities based on the data available.</p>
    <p id="work-text-7"><strong>Note:</strong> Forecastler does not provide medical, financial, or legal advice. Treat the results as decision support, not as guaranteed outcomes.</p>
  </div>

  <!-- SECTION 3: The Development of Forecastler -->
  <div class="main-section">
    <h2 id="dev-title">The Development of Forecastler</h2>
    <p id="dev-text-1">Forecastler, as a platform and interface for AI-assisted prediction, has been under development since <strong>December 2024</strong> in <strong>Subotica, Republic of Serbia</strong>. The project was officially launched on <strong>June 17, 2025</strong>, and continues to evolve through iterative development.</p>
    <p id="dev-text-2">Behind Forecastler stands the <strong>Forecastler team</strong> from Subotica—a blend of engineering, analytical, and design experience with a shared mission: to make forecasts clear, useful, and fair for users.</p>
    <p id="dev-text-3"><strong>Planned improvements:</strong> Feature expansions (more question types, additional output indicators, more flexible response formats).</p>
    <p id="dev-text-4">Algorithmic enhancements (better fusion of contextual information and statistics; more robust estimates with less input data).</p>
    <p id="dev-text-5">Interface optimization (quicker input, clearer guidance for high-quality inputs, improved accessibility).</p>
    <p id="dev-text-6">Greater transparency (clearer explanations of why an estimate is what it is, where the model’s limits are, and how to improve your input).</p>
    <p id="dev-text-7">We believe the future should not be an enigma but an informed set of probabilities anyone can understand. If you share that vision, you’re welcome to ask, test, and suggest—because Forecastler grows alongside its community of users.</p>
  </div>

  <footer style="padding: 2rem; background-color: rgba(0, 0, 0, 0.6); font-size: 0.95rem; color: white; text-align: center;">
    <div style="margin-bottom: 1rem;">
      <a id="link-disclaimer" href="disclaimer.html" style="margin: 0 0.5rem; color: inherit; text-decoration: none;">Disclaimer</a> |
      <a id="link-terms"      href="terms.html"      style="margin: 0 0.5rem; color: inherit; text-decoration: none;">Terms of Use</a> |
      <a id="link-privacy"    href="privacy.html"    style="margin: 0 0.5rem; color: inherit; text-decoration: none;">Privacy Policy</a> |
      <a id="link-cookies"    href="cookies.html"    style="margin: 0 0.5rem; color: inherit; text-decoration: none;">Cookie Policy</a> |
      <a id="link-sitemap"    href="sitemap.html"    style="margin: 0 0.5rem; color: inherit; text-decoration: none;">Sitemap</a> |
      <a id="link-faq"        href="faq.html"        style="margin: 0 0.5rem; color: inherit; text-decoration: none;">FAQ</a>
    </div>
    <div style="margin-bottom: 0.5rem;">
      e-mail: <strong>forecastler@gmail.com</strong> | Facebook: | Instagram: | Youtube: | TikTok:
    </div>
    <div>
      Created by Miroslav Ostrogonac, 2025.
    </div>
  </footer>

  <script src="lang.js"></script>

  <script>
  function countWords(text) {
    return text.trim().split(/\s+/).filter(Boolean).length;
  }

  // Ograničenje za opis (max 1000 reči)
  document.getElementById("kontekst").addEventListener("input", function() {
    let words = countWords(this.value);
    if (words > 1000) {
      alert(T().limits.descriptionMax); // koristi prevod
      this.value = this.value.trim().split(/\s+/).slice(0, 1000).join(" ");
    }
  });

  // Ograničenje za pitanje (max 100 reči)
  document.getElementById("pitanje").addEventListener("input", function() {
    let words = countWords(this.value);
    if (words > 100) {
      alert(T().limits.questionMax); // koristi prevod
      this.value = this.value.trim().split(/\s+/).slice(0, 100).join(" ");
    }
  });

  // Ključ u localStorage (po želji možeš i po jeziku: `${trenutniJezik}:forecastler:context`)
    const CONTEXT_KEY = "forecastler:context:v1";

  // Helper koji uvek vraća odgovarajući skup poruka
  const T = () => (translations[trenutniJezik] || translations.en);

  function applyRuntimeTranslations() {
    const t = T();

  const setTxt = (id, txt) => {
      const el = document.getElementById(id);
      if (el && typeof txt === "string") el.textContent = txt;
    };

    // Header links (desktop + mobile)
    if (t.headerLinks){
      setTxt("nav-home",     t.headerLinks.home);
      setTxt("nav-about",    t.headerLinks.about);
      setTxt("nav-contact",  t.headerLinks.contact);
      setTxt("nav-blog",     t.headerLinks.blog);

      setTxt("mnav-home",    t.headerLinks.home);
      setTxt("mnav-about",   t.headerLinks.about);
      setTxt("mnav-contact", t.headerLinks.contact);
      setTxt("mnav-blog",    t.headerLinks.blog);
    }

    // Dugmad (label)
    const newBtn = document.querySelector("#new-subject .btn-label");
    const saveBtn = document.querySelector("#save-subject .btn-label");
    const delBtn  = document.querySelector("#delete-subject .btn-label");
    if (newBtn) newBtn.textContent = t.buttons.new;
    if (saveBtn) saveBtn.textContent = t.buttons.save;
    if (delBtn)  delBtn.textContent  = t.buttons.delete;

    // Ikonice nad opisom (title/aria-label)
    const saveDesc = document.getElementById("save-context");
    const delDesc  = document.getElementById("clear-context");
    if (saveDesc) {
      saveDesc.title = t.buttons.saveDescription;
      saveDesc.setAttribute("aria-label", t.buttons.saveDescription);
    }
    if (delDesc) {
      delDesc.title = t.buttons.deleteDescription;
      delDesc.setAttribute("aria-label", t.buttons.deleteDescription);
    }

    // Placeholder za ime subjekta
    const nameInput = document.getElementById("subject-name");
    if (nameInput) nameInput.placeholder = t.placeholders.subjectName;

    // Dugme za slanje pitanja (label + aria)
    const sendBtn = document.getElementById("send-button");
    if (sendBtn) {
      sendBtn.querySelector(".btn-label").textContent = t.sendButton;
      sendBtn.title = t.sendButton;
      sendBtn.setAttribute("aria-label", t.sendButton);
    }

    // Dugmad za CRUD subjekta – title/aria-label
    const btnNew = document.getElementById("new-subject");
    const btnSave = document.getElementById("save-subject");
    const btnDelete = document.getElementById("delete-subject");
    if (btnNew)   { btnNew.title = t.buttons.new;   btnNew.setAttribute("aria-label", t.buttons.new); }
    if (btnSave)  { btnSave.title = t.buttons.save; btnSave.setAttribute("aria-label", t.buttons.save); }
    if (btnDelete){ btnDelete.title = t.buttons.delete; btnDelete.setAttribute("aria-label", t.buttons.delete); }
  }

    // Učitaj sačuvan opis pri učitavanju stranice
    function loadSavedContext() {
      const saved = localStorage.getItem(CONTEXT_KEY);
      if (saved) {
        const ta = document.getElementById("kontekst");
        ta.value = saved;

        // osiguraj limit od 1000 reči i posle učitavanja
        const words = ta.value.trim().split(/\s+/).filter(Boolean);
        if (words.length > 1000) {
          ta.value = words.slice(0, 1000).join(" ");
        }
      }
    }

    // Ručno čuvanje klikom na dugme
    function saveContext() {
      const ta = document.getElementById("kontekst");
      localStorage.setItem(CONTEXT_KEY, ta.value.trim());
      const s = document.getElementById("save-status");
      s.textContent = T().context.saved;
      setTimeout(() => (s.textContent = ""), 2000);
    }

    // Brisanje sačuvanog teksta
    function clearContext() {
      if (!confirm(T().alerts.confirmDeleteDescription)) return;
      localStorage.removeItem(CONTEXT_KEY);
      document.getElementById("kontekst").value = "";
      const s = document.getElementById("save-status");
      s.textContent = T().context.cleared;
      setTimeout(() => (s.textContent = ""), 2000);
    }

    // Auto-save sa debounce (prijatnije od stalnih alert-a)
    let saveTimer;
    document.getElementById("kontekst").addEventListener("input", () => {
      clearTimeout(saveTimer);
      saveTimer = setTimeout(() => {
        localStorage.setItem(CONTEXT_KEY, document.getElementById("kontekst").value.trim());
      }, 600);
   });

    // Poveži dugmad
    document.addEventListener("DOMContentLoaded", () => {
      const saveBtn = document.getElementById("save-context");
      const clearBtn = document.getElementById("clear-context");
      if (saveBtn) saveBtn.addEventListener("click", saveContext);
      if (clearBtn) clearBtn.addEventListener("click", clearContext);
      loadSavedContext(); // učitaj ako postoji
      applyRuntimeTranslations();
    });

    // ==== MULTI-SUBJECT STORAGE (localStorage) ====
    const CONTEXTS_KEY = "forecastler:contexts:v1";   // mapa: { key: { name, text, ts } }
    const CURRENT_KEY  = "forecastler:currentKey:v1"; // aktivni subjekat (key)

    const ctxTA = document.getElementById("kontekst");
    const nameInput = document.getElementById("subject-name");
    const listBox = document.getElementById("subject-list");
    const saveBtn = document.getElementById("save-subject");
    const delBtn  = document.getElementById("delete-subject");

    const newBtn  = document.getElementById("new-subject");

    function newSubject() {
      // (opciono) upozorenje ako je nešto menjano u aktivnom subjektu
      const cur = getCurrentKey();
      if (cur) {
        const store = getStore();
        if (store[cur] && store[cur].text !== ctxTA.value.trim()) {
          const ok = confirm(T().subjects.unsavedChangesConfirm);
          if (!ok) return;
        }
     }
      setCurrentKey("");          // nema aktivnog subjekta
      nameInput.value = "";       // prazno ime
      ctxTA.value = "";           // prazna deskripcija
      renderSubjects();           // osveži listu (Delete se automatski disabluje)
      const s = document.getElementById("save-status");
      if (s) { s.textContent = T().subjects.new; setTimeout(()=> s.textContent="", 1500); }
    }

    newBtn.addEventListener("click", newSubject);

    // util
    function slugifyName(s){
      return s.trim().toLowerCase()
        .normalize("NFD").replace(/[\u0300-\u036f]/g,"")
        .replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").slice(0,80);
    }
    function getStore(){ try{return JSON.parse(localStorage.getItem(CONTEXTS_KEY))||{}}catch{ return {}; } }
    function setStore(obj){ localStorage.setItem(CONTEXTS_KEY, JSON.stringify(obj)); }
    function getCurrentKey(){ return localStorage.getItem(CURRENT_KEY) || ""; }
    function setCurrentKey(k){ if(k) localStorage.setItem(CURRENT_KEY,k); else localStorage.removeItem(CURRENT_KEY); }

    // render liste
    function renderSubjects(){
      const store = getStore();
      const cur = getCurrentKey();
      listBox.innerHTML = "";
      Object.entries(store)
        .sort((a,b)=> (b[1].ts||0)-(a[1].ts||0)) // najskoriji prvi
        .forEach(([key, item])=>{
          const chip = document.createElement("span");
          chip.className = "subject-chip" + (key===cur ? " active" : "");
          chip.textContent = item.name;
          chip.onclick = ()=> loadSubject(key);
          listBox.appendChild(chip);
        });
      delBtn.disabled = !cur;
    }

    // učitaj subjekat u polje
    function loadSubject(key){
      const store = getStore();
      const item = store[key];
      if(!item) return;
      setCurrentKey(key);
      nameInput.value = item.name;

      // poštuj limit 1000 reči i pri učitavanju
      const words = item.text.trim().split(/\s+/).filter(Boolean);
      ctxTA.value = words.length>1000 ? words.slice(0,1000).join(" ") : item.text;

      // auto-upiši eventualno skraćen tekst nazad
      if(words.length>1000){ 
        store[key].text = ctxTA.value.trim(); 
        setStore(store); 
      }
      renderSubjects();
    }

    // snimi/ ažuriraj subjekat
    function saveSubject(){
      const name = nameInput.value.trim();
      if(!name){ alert("Enter subject label first."); return; }
      const key = slugifyName(name);
      if(!key){ alert("Subject label is not valid."); return; }

      const store = getStore();
      store[key] = {
        name,
        text: ctxTA.value.trim(),
        ts: Date.now()
      };
      setStore(store);
      setCurrentKey(key);
      renderSubjects();

      const s = document.getElementById("save-status");
      if(s){ s.textContent = "Saved subject."; setTimeout(()=>s.textContent="", 1500); }
    }

    // obriši aktivni
    function deleteSubject(){
      const key = getCurrentKey();
      if(!key) return;
      if(!confirm("Delete the current subject?")) return;
      const store = getStore();
      delete store[key];
      setStore(store);
      setCurrentKey("");
      nameInput.value = "";
      ctxTA.value = "";
      renderSubjects();
    }

    // autosave aktivnog pri kucanju (debounce)
    let subjTimer;
    ctxTA.addEventListener("input", ()=>{
      clearTimeout(subjTimer);
      subjTimer = setTimeout(()=>{
        const key = getCurrentKey();
        if(!key) return; // ništa ako nije izabran subjekat
        const store = getStore();
        if(store[key]){
          // osiguraj limit pre upisa
          const words = ctxTA.value.trim().split(/\s+/).filter(Boolean);
          store[key].text = words.length>1000 ? words.slice(0,1000).join(" ") : ctxTA.value.trim();
          store[key].ts = Date.now();
          setStore(store);
        }
      }, 600);
    });

    // događaji dugmadi i inicijalizacija
    saveBtn.addEventListener("click", saveSubject);
    delBtn.addEventListener("click", deleteSubject);

    // Ako postoji aktivni, učitaj; inače samo prikaži listu
    document.addEventListener("DOMContentLoaded", ()=>{
      renderSubjects();
      const cur = getCurrentKey();
      if(cur) loadSubject(cur);
    });

    async function posaljiPitanje() {
      const kontekst = document.getElementById("kontekst").value.trim();
      const pitanje = document.getElementById("pitanje").value.trim();
      const odgovorText = document.getElementById("odgovor-tekst");
      const verovatnocaText = document.getElementById("odgovor-verovatnoca");

      odgovorText.style.display = "none";
      verovatnocaText.style.display = "none";
      odgovorText.textContent = "";
      verovatnocaText.textContent = "";

      if (!pitanje) {
        alert("Enter a question before submitting.");
        return;
      }

      const dateRegex = /([0-3]?\d)[.\/\-]([01]?\d)[.\/\-](\d{4})/g;
      let match;
      let foundPastDate = false;

      while ((match = dateRegex.exec(pitanje)) !== null) {
        const [dan, mesec, godina] = [parseInt(match[1]), parseInt(match[2]), parseInt(match[3])];
        const datumIzPitanja = new Date(godina, mesec - 1, dan);
        const danasnjiDatum = new Date();
        if (datumIzPitanja < danasnjiDatum) {
          foundPastDate = true;
          break;
        }
      }

      if (foundPastDate) {
        alert("Ask a question related to the future.");
        return;
      }

      const danas = new Date().toLocaleDateString('sr-RS');
      const uvodniTekst = `Današnji datum je ${danas}.`;
      const pitanjeZaSlanje = uvodniTekst + "\n\n" + kontekst + "\n\nPitanje: " + pitanje;

      try {
        const res = await fetch("https://moj-vrac-api.onrender.com/api/v1/da-li-ce-se-desiti", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({ 
            pitanje: pitanjeZaSlanje,
            jezik: trenutniJezik 
          })
        });

        if (res.status === 400) {
          const podaci = await res.json();
          alert(podaci.poruka || "The answer is not in a recognizable format.");
          return;
        }

        const data = await res.json();
        const [odgovorRaw, , procenat] = (data.odgovor || "").split(" ");
        const odgovor = odgovorRaw.replace(",", "");
        const t = translations[trenutniJezik];

        if (odgovor && procenat) {
          odgovorText.innerHTML = `<span style="color: ${odgovor === t.answers.yes ? "green" : "red"}">${t.dynamic.answerLabel} ${odgovor}</span>`;
          verovatnocaText.innerHTML = `${t.dynamic.probabilityLabel} <strong>${procenat}</strong>`;
          odgovorText.style.display = "block";
          verovatnocaText.style.display = "block";
        } else {
          odgovorText.textContent = t.alerts.unrecognizedResponse;
          odgovorText.style.display = "block";
        }

      } catch (err) {
        odgovorText.textContent = t.alerts.serverError;
        odgovorText.style.display = "block";
      }
    }
  </script>

  <script>
    const supportedLanguages = [
      'en', 'sr', 'es', 'fr', 'de', 'it', 'pt', 'pl',
      'ru', 'uk', 'tr', 'ar', 'hi', 'zh', 'ja'
    ];

    function detectLanguage() {
      const savedLang = localStorage.getItem('forecastlerLang');
      if (savedLang && supportedLanguages.includes(savedLang)) {
        setLanguage(savedLang);
        return;
      }

      const browserLang = navigator.language.slice(0, 2);
      const fallbackLang = 'en';

      if (supportedLanguages.includes(browserLang)) {
        setLanguage(browserLang);
      } else {
        setLanguage(fallbackLang);
      }
    }

    window.addEventListener('DOMContentLoaded', detectLanguage);

  (function(){
    const btn = document.getElementById('menu-button');
    const dd  = document.getElementById('menu-dropdown');

    if(!btn || !dd) return;

    function closeMenu(){
      dd.classList.remove('open');
      btn.setAttribute('aria-expanded','false');
    }
    function toggleMenu(e){
      e.stopPropagation();
      const isOpen = dd.classList.toggle('open');
      btn.setAttribute('aria-expanded', String(isOpen));
    }

    btn.addEventListener('click', toggleMenu);

    // Zatvaranje na klik van menija
    document.addEventListener('click', (e)=>{
      if(!dd.classList.contains('open')) return;
      const clickedInside = dd.contains(e.target) || btn.contains(e.target);
      if(!clickedInside) closeMenu();
    });

    // Zatvaranje na Escape
    document.addEventListener('keydown', (e)=>{ if(e.key === 'Escape') closeMenu(); });

    // Zatvori nakon klika na stavku menija
    dd.querySelectorAll('.menu-item').forEach(a=>{
      a.addEventListener('click', closeMenu);
    });

    // (opciono) Ako budeš želeo prevod naslova menija:
    // ako u translations[lang].headerLinks postoji, primeni:
    if (typeof T === 'function') {
      const t = T();
      if (t.headerLinks){
        const map = {
          'nav-home':'home',
          'nav-about':'about',
          'nav-contact':'contact',
          'nav-blog':'blog'
        };
        Object.entries(map).forEach(([id,key])=>{
          const el = document.getElementById(id);
          if (el && t.headerLinks[key]) el.textContent = t.headerLinks[key];
        });
      }
    }
  })();

  function toggleMenu() {
    var menu = document.getElementById("menuDropdown");
    menu.style.display = (menu.style.display === "block") ? "none" : "block";
  }
  </script>

</body>
</html>
